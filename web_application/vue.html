<script src="https://cdn.jsdelivr.net/npm/vue@2.6.14/dist/vue.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vuetify@2.x/dist/vuetify.js"></script>
<script>
  var app = new Vue({
    el: '#app',
    vuetify: new Vuetify(),
    data: () => ({
      value: ' ',
      overlay: true,
    }),
    created: async function () {
      await this.loadValue().then(this.onFulfilled, this.onRejected)
      this.overlay = false
    },
    methods: {
      loadValue: async function () {
        return new Promise (function(resolve, reject){
          google.script.run
            .withSuccessHandler(function(result){
              resolve(result)
            })
            .withFailureHandler(function(error){
              reject(error)
            })
            .getCountFromGpc(1);
        })
      },
      onFulfilled: function (sheetValue) {
        this.value = sheetValue
      },
      onRejected: function (error) {
        alert("エラーが発生しました。")
      },
      count: function () {
        this.value += 1
      },
      resetCount: function () {
        this.value = 0
      },
      saveCount: function () {
        google.script.run.withSuccessHandler(alert("保存しました。")).saveCountToGpc(this.value);
      }
    }
  })
</script>
